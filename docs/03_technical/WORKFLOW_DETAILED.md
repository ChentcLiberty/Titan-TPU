# 04 - 详细工作流程

> 12周完整开发计划，包含每日任务、验收标准、风险管理

---

## 📋 目录

1. [总体时间线](#1-总体时间线)
2. [Phase 1: 核心理解 (Week 1-2)](#2-phase-1-核心理解-week-1-2)
3. [Phase 2: 魔改特性 (Week 3-4)](#3-phase-2-魔改特性-week-3-4)
4. [Phase 3: 系统集成 (Week 5-6)](#4-phase-3-系统集成-week-5-6)
5. [Phase 4: 验证环境 (Week 7-8)](#5-phase-4-验证环境-week-7-8)
6. [Phase 5: 综合分析 (Week 9-10)](#6-phase-5-综合分析-week-9-10)
7. [Phase 6: 面试准备 (Week 11-12)](#7-phase-6-面试准备-week-11-12)
8. [风险管理](#8-风险管理)
9. [检查清单](#9-检查清单)

---

## 1. 总体时间线

```
┌─────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                    12 周开发时间线                                                   │
├─────────────────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                                     │
│  Week:  1    2    3    4    5    6    7    8    9    10   11   12                                  │
│        ├────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┼────┤                              │
│        │▓▓▓▓▓▓▓▓▓│    │    │    │    │    │    │    │    │    │    │  Phase 1: 核心理解            │
│        │    │    │▓▓▓▓▓▓▓▓▓│    │    │    │    │    │    │    │    │  Phase 2: 魔改特性            │
│        │    │    │    │    │▓▓▓▓▓▓▓▓▓│    │    │    │    │    │    │  Phase 3: 系统集成            │
│        │    │    │    │    │    │    │▓▓▓▓▓▓▓▓▓│    │    │    │    │  Phase 4: 验证环境            │
│        │    │    │    │    │    │    │    │    │▓▓▓▓▓▓▓▓▓│    │    │  Phase 5: 综合分析            │
│        │    │    │    │    │    │    │    │    │    │    │▓▓▓▓▓▓▓▓▓│  Phase 6: 面试准备            │
│        └────┴────┴────┴────┴────┴────┴────┴────┴────┴────┴────┴────┘                              │
│                    │                   │                        │                                   │
│                    ▼                   ▼                        ▼                                   │
│              ════════════        ════════════              ════════════                             │
│              ║成都实习投递║        ║核心功能完成║              ║秋招投递  ║                             │
│              ════════════        ════════════              ════════════                             │
│                                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

### 1.1 里程碑定义

| 里程碑 | 周数 | 验收标准 | 面试价值 |
|--------|------|----------|----------|
| **M1** | Week 2 | PE + Systolic 测试通过 | 能解释 MAC 和数据流 |
| **M2** | Week 4 | ECC + Sparse 功能完成 | 能讲魔改特性 |
| **M3** | Week 6 | 系统集成测试通过 | 有可演示项目 |
| **M4** | Week 8 | UVM 覆盖率 > 90% | 验证能力证明 |
| **M5** | Week 10 | 综合 PPA 数据 | 有量化指标 |
| **M6** | Week 12 | 完整文档 + 面试准备 | 求职就绪 |

---

## 2. Phase 1: 核心理解 (Week 1-2)

### 2.1 Week 1: 环境搭建 + PE 模块

#### Day 1: 项目初始化 ✅

| 时间 | 任务 | 工具 | 验收标准 |
|------|------|------|----------|
| 上午 | Clone tiny-tpu-v2 | Git | `ls _vendor/tiny-tpu-v2/src` 显示 17 个文件 |
| 上午 | Clone verilog-axi | Git | `ls _vendor/verilog-axi` 显示文件 |
| 下午 | 创建项目目录结构 | Bash | 所有目录存在 |
| 下午 | 创建 env_setup.sh | Vim | `source env_setup.sh` 成功 |
| 下午 | 创建 Makefile | Vim | `make help` 显示帮助 |
| 晚上 | 创建 tb_pe.sv | Vim | 文件存在 |

**完成标志**:
- [x] 所有文件下载完成
- [x] 环境脚本可用
- [ ] VCS 能编译 (遇到 bug)

#### Day 2: 修复 PE Bug + 测试通过

| 时间 | 任务 | 工具 | 验收标准 |
|------|------|------|----------|
| 上午 | 分析 pe.sv bug | Claude API | 理解多驱动问题 |
| 上午 | 修复 pe.sv | Vim | `make check_pe` 通过 |
| 下午 | 运行 PE 测试 | VCS | `make pe` 显示 PASS |
| 下午 | 分析波形 | Verdi | 能看到 MAC 结果 |
| 晚上 | 记录 Debug | Markdown | 更新 DEBUG_LOG.md |

**验收测试**:
```bash
cd sim/vcs
make pe
# 期望输出: "✅ PASS!"
```

#### Day 3: 理解 PE 原理

| 时间 | 任务 | 工具 | 验收标准 |
|------|------|------|----------|
| 上午 | 阅读 pe.sv 源码 | Vim | 能说出每个端口作用 |
| 上午 | 学习 MAC 运算 | NotebookLM | 能手算 1.5 × 2.0 |
| 下午 | 学习 Weight Stationary | NotebookLM | 能解释 vs Output Stationary |
| 下午 | 绘制 PE 框图 | 手绘/Mermaid | 框图正确 |
| 晚上 | 准备面试问答 | Claude Opus | 3 个问答 ready |

**面试准备**:
```
Q1: PE 的 MAC 运算是什么？
A1: Multiply-Accumulate，psum_out = weight × input + psum_in

Q2: 为什么用 Weight Stationary？
A2: 权重固定在 PE 中，最大化权重复用，减少内存带宽

Q3: Q8.8 是什么？
A3: 定点数格式，8 位整数 + 8 位小数，范围 -128 ~ +127.996
```

#### Day 4: 理解定点数

| 时间 | 任务 | 工具 | 验收标准 |
|------|------|------|----------|
| 上午 | 学习 Q8.8 格式 | NotebookLM | 能解释格式 |
| 上午 | 手算定点数乘法 | 纸笔 | 计算正确 |
| 下午 | 阅读 fixedpoint.sv | Vim | 理解截断逻辑 |
| 下午 | 写定点数测试 | VCS | 测试通过 |
| 晚上 | 文档更新 | Markdown | README 更新 |

**练习**:
```
计算 Q8.8 乘法: 1.5 × 2.0

1.5 = 0x0180 (1×256 + 0.5×256 = 384)
2.0 = 0x0200 (2×256 = 512)

乘法: 384 × 512 = 196608 (0x30000)
结果 Q16.16 = 0x00030000
截断 Q8.8 = 0x0300 = 768/256 = 3.0 ✓
```

#### Day 5-6: Systolic Array

| 天 | 时间 | 任务 | 工具 | 验收标准 |
|----|------|------|------|----------|
| 5 | 上午 | 阅读 systolic.sv | Vim | 理解 PE 连接 |
| 5 | 下午 | 绘制数据流图 | 手绘 | 图正确 |
| 5 | 晚上 | 创建 tb_systolic.sv | Vim | 文件存在 |
| 6 | 上午 | 运行测试 | VCS | 测试通过 |
| 6 | 下午 | 分析波形 | Verdi | 理解时序 |
| 6 | 晚上 | 文档更新 | Markdown | 学习笔记 |

**验收测试**:
```bash
make systolic
# 期望: 2×2 矩阵乘法结果正确
```

#### Day 7: Week 1 总结

| 时间 | 任务 | 工具 | 验收标准 |
|------|------|------|----------|
| 上午 | 复习所有代码 | Vim | 能快速定位 |
| 下午 | 整理学习笔记 | Markdown | 笔记完整 |
| 下午 | 更新进度 | Markdown | 进度条准确 |
| 晚上 | 模拟面试 | Claude Opus | 能回答 5 个问题 |

### 2.2 Week 2: VPU + Control Unit + 整合

#### Day 8-9: VPU 理解

| 天 | 任务 | 验收标准 |
|----|------|----------|
| 8 | 阅读 bias_*.sv | 理解偏置加法 |
| 8 | 阅读 leaky_relu_*.sv | 理解激活函数 |
| 9 | 阅读 vpu.sv | 理解顶层连接 |
| 9 | 绘制 VPU 框图 | 框图正确 |

#### Day 10-11: Control Unit

| 天 | 任务 | 验收标准 |
|----|------|----------|
| 10 | 阅读 control_unit.sv | 理解 94-bit ISA |
| 10 | 绘制 FSM | 状态图正确 |
| 11 | 阅读 tpu.sv | 理解顶层集成 |
| 11 | 运行顶层测试 | 测试通过 |

#### Day 12-13: Golden Model

| 天 | 任务 | 验收标准 |
|----|------|----------|
| 12 | 创建 golden_model.py | PE 计算正确 |
| 12 | 添加 Systolic Array | 矩阵乘法正确 |
| 13 | 对比 RTL vs Python | 结果一致 |
| 13 | 自动化测试脚本 | 一键测试 |

#### Day 14: Phase 1 总结

**验收清单**:
- [ ] PE 测试 PASS
- [ ] Systolic 测试 PASS
- [ ] Golden Model 对比 PASS
- [ ] 能解释所有模块
- [ ] 5 个面试问答 ready

---

## 3. Phase 2: 魔改特性 (Week 3-4)

### 3.1 Week 3: ECC SECDED

#### Day 15: 学习 Hamming 码

| 时间 | 任务 | 工具 | 验收标准 |
|------|------|------|----------|
| 上午 | 学习 Hamming 原理 | NotebookLM | 能解释 SEC/DED |
| 下午 | 手算 Hamming(7,4) | 纸笔 | 计算正确 |
| 晚上 | 设计 Hamming(39,32) | Claude Opus | 校验矩阵 ready |

**练习**:
```
Hamming(7,4) 编码:
数据: d1d2d3d4 = 1011

校验位:
p1 = d1⊕d2⊕d4 = 1⊕0⊕1 = 0
p2 = d1⊕d3⊕d4 = 1⊕1⊕1 = 1
p3 = d2⊕d3⊕d4 = 0⊕1⊕1 = 0

编码: p1p2d1p3d2d3d4 = 0110011
```

#### Day 16: 设计 ECC 模块

| 时间 | 任务 | 工具 | 验收标准 |
|------|------|------|----------|
| 上午 | 设计接口 | Claude Opus | 接口定义完成 |
| 下午 | 设计架构 | Claude Opus | 架构图完成 |
| 晚上 | 编写设计文档 | Markdown | 文档完成 |

#### Day 17-18: 实现 ECC RTL

| 天 | 时间 | 任务 | 验收标准 |
|----|------|------|----------|
| 17 | 上午 | 实现编码器 | 编译通过 |
| 17 | 下午 | 实现解码器 | 编译通过 |
| 18 | 上午 | 实现顶层 | 编译通过 |
| 18 | 下午 | 代码审查 | 无 warning |

#### Day 19-20: ECC 验证

| 天 | 时间 | 任务 | 验收标准 |
|----|------|------|----------|
| 19 | 上午 | 创建 tb_ecc.sv | 编译通过 |
| 19 | 下午 | 正常编解码测试 | 测试通过 |
| 20 | 上午 | 单比特错误测试 | 纠错正确 |
| 20 | 下午 | 双比特错误测试 | 检测正确 |

#### Day 21: 集成到 Buffer

| 时间 | 任务 | 验收标准 |
|------|------|----------|
| 上午 | 修改 unified_buffer.sv | 编译通过 |
| 下午 | 集成测试 | 功能正确 |
| 晚上 | 文档更新 | 完成 |

### 3.2 Week 4: Sparse 优化

#### Day 22: 设计 Sparse PE

| 时间 | 任务 | 验收标准 |
|------|------|----------|
| 上午 | 设计零值检测 | 接口定义 |
| 下午 | 设计 Clock Gating | ICG 方案 |
| 晚上 | 设计文档 | 完成 |

#### Day 23-24: 实现 Sparse PE

| 天 | 任务 | 验收标准 |
|----|------|----------|
| 23 | 实现 pe_sparse.sv | 编译通过 |
| 23 | 实现 clock_gate.sv | 编译通过 |
| 24 | 集成测试 | 功能正确 |
| 24 | 功耗对比 | 有数据 |

#### Day 25-28: Sparse 完善 + Phase 2 总结

| 天 | 任务 | 验收标准 |
|----|------|----------|
| 25 | 边界条件测试 | 全部通过 |
| 26 | 功耗分析文档 | 完成 |
| 27 | 代码整理 | 风格统一 |
| 28 | Phase 2 总结 | 文档完成 |

**Phase 2 验收**:
- [ ] ECC 编解码测试 PASS
- [ ] 单比特纠错测试 PASS
- [ ] 双比特检错测试 PASS
- [ ] Sparse 功能测试 PASS
- [ ] 功耗数据文档化

---

## 4. Phase 3: 系统集成 (Week 5-6)

### 4.1 Week 5: AXI 接口

#### Day 29-30: AXI 学习

| 天 | 任务 | 验收标准 |
|----|------|----------|
| 29 | 下载 TAXI 库 | 文件存在 |
| 29 | 学习 AXI 协议 | 能解释 5 通道 |
| 30 | 学习 TAXI 用法 | 能看懂示例 |
| 30 | 设计寄存器映射 | 地址表完成 |

#### Day 31-35: 实现 + 测试

| 天 | 任务 | 验收标准 |
|----|------|----------|
| 31-32 | 实现 axi_tpu_wrapper.sv | 编译通过 |
| 33 | 创建 tb_axi.sv | 编译通过 |
| 34 | AXI 读写测试 | 功能正确 |
| 35 | 集成测试 | 通过 |

### 4.2 Week 6: 系统联调

#### Day 36-42: 全系统集成

| 天 | 任务 | 验收标准 |
|----|------|----------|
| 36-37 | 顶层集成 | 编译通过 |
| 38-39 | 端到端测试 | 功能正确 |
| 40-41 | Debug + 优化 | 所有问题修复 |
| 42 | Phase 3 总结 | 可演示 |

**Phase 3 验收**:
- [ ] AXI 读写正确
- [ ] 端到端矩阵乘法正确
- [ ] 可以演示给面试官

---

## 5. Phase 4: 验证环境 (Week 7-8)

### 5.1 Week 7: UVM 基础

| 天 | 任务 | 验收标准 |
|----|------|----------|
| 43-44 | 学习 UVM 基础 | 理解组件 |
| 45-46 | 创建 tpu_env | 编译通过 |
| 47-49 | 创建 agent | 编译通过 |

### 5.2 Week 8: 覆盖率

| 天 | 任务 | 验收标准 |
|----|------|----------|
| 50-52 | 功能覆盖率 | > 90% |
| 53-54 | 代码覆盖率 | > 85% |
| 55-56 | 覆盖率报告 | 文档完成 |

---

## 6. Phase 5: 综合分析 (Week 9-10)

### 6.1 Week 9: DC 综合

| 天 | 任务 | 验收标准 |
|----|------|----------|
| 57-58 | 综合脚本 | syn.tcl 完成 |
| 59-60 | 运行综合 | 无 error |
| 61-63 | 时序分析 | 达标 |

### 6.2 Week 10: PPA 优化

| 天 | 任务 | 验收标准 |
|----|------|----------|
| 64-66 | 面积优化 | 有数据 |
| 67-68 | 功耗分析 | 有数据 |
| 69-70 | PPA 报告 | 文档完成 |

---

## 7. Phase 6: 面试准备 (Week 11-12)

### 7.1 Week 11: 文档整理

| 天 | 任务 | 验收标准 |
|----|------|----------|
| 71-73 | 项目文档 | README 完整 |
| 74-75 | 技术博客 | 发布 2 篇 |
| 76-77 | 简历更新 | 项目突出 |

### 7.2 Week 12: 面试冲刺

| 天 | 任务 | 验收标准 |
|----|------|----------|
| 78-80 | 问答准备 | 20 个问答 |
| 81-82 | 模拟面试 | 自信回答 |
| 83-84 | 投递 + 面试 | 获得机会 |

---

## 8. 风险管理

### 8.1 风险识别

| 风险 | 概率 | 影响 | 应对措施 |
|------|------|------|----------|
| VCS Bug 难以解决 | 高 | 高 | 使用 Claude API 快速调试 |
| ECC 设计复杂 | 中 | 中 | 先实现简化版 Hamming(7,4) |
| AXI 集成困难 | 中 | 中 | 使用成熟库 TAXI |
| 时间不足 | 高 | 高 | 优先核心功能，砍掉可选项 |
| 面试准备不足 | 中 | 高 | 每周准备 5 个问答 |

### 8.2 备用计划

```
如果 Week 4 还未完成 ECC:
  → 砍掉 Sparse，专注 ECC
  
如果 Week 6 还未完成 AXI:
  → 使用简单接口代替 AXI
  
如果 Week 8 UVM 太难:
  → 使用 SV Testbench，放弃 UVM

最小可行项目 (MVP):
  ✓ PE 测试通过
  ✓ Systolic 测试通过
  ✓ ECC 功能演示
  → 足够找实习
```

---

## 9. 检查清单

### 9.1 每日检查

- [ ] 更新进度追踪
- [ ] 提交 Git commit
- [ ] 记录学到的知识点

### 9.2 每周检查

- [ ] 里程碑是否达成
- [ ] 进度是否落后
- [ ] 文档是否更新
- [ ] 面试问答是否增加

### 9.3 Phase 检查

- [ ] 验收标准全部满足
- [ ] 所有测试通过
- [ ] 文档完整
- [ ] 可以演示

---

*文档版本: v1.0 | 更新时间: 2025-01-16*
