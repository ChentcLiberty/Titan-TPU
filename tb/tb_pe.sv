`timescale 1ns/1ps
`default_nettype none

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PE Module Testbench - Professional Version
// Author: Chen Weidong
// Date: 2026-01-20
//
// Features:
// - FSDB waveform generation for Verdi
// - Self-checking test cases
// - Comprehensive test coverage
// - Clear pass/fail reporting
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

module tb_pe;

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ä¿¡å·å£°æ˜
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    logic clk;
    logic rst;

    // North wires (from above)
    logic signed [15:0] pe_psum_in;
    logic signed [15:0] pe_weight_in;
    logic pe_accept_w_in;

    // West wires (from left)
    logic signed [15:0] pe_input_in;
    logic pe_valid_in;
    logic pe_switch_in;
    logic pe_enabled;

    // South wires (to below)
    logic signed [15:0] pe_psum_out;
    logic signed [15:0] pe_weight_out;

    // East wires (to right)
    logic signed [15:0] pe_input_out;
    logic pe_valid_out;
    logic pe_switch_out;

    // æµ‹è¯•ç»Ÿè®¡
    int test_count = 0;
    int pass_count = 0;
    int fail_count = 0;

    // éšæœºæµ‹è¯•é…ç½®
    int random_test_num = 10;  // éšæœºæµ‹è¯•æ•°é‡

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // DUT å®ä¾‹åŒ–
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    pe #(
        .DATA_WIDTH(16)
    ) dut (
        .clk(clk),
        .rst(rst),
        .pe_psum_in(pe_psum_in),
        .pe_weight_in(pe_weight_in),
        .pe_accept_w_in(pe_accept_w_in),
        .pe_input_in(pe_input_in),
        .pe_valid_in(pe_valid_in),
        .pe_switch_in(pe_switch_in),
        .pe_enabled(pe_enabled),
        .pe_psum_out(pe_psum_out),
        .pe_weight_out(pe_weight_out),
        .pe_input_out(pe_input_out),
        .pe_valid_out(pe_valid_out),
        .pe_switch_out(pe_switch_out)
    );

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Clocking Block - SystemVerilog æ ‡å‡†æ—¶åºç®¡ç†
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    //
    // Clocking Block çš„ä½œç”¨ï¼š
    // 1. è‡ªåŠ¨å¤„ç†ä¿¡å·çš„é‡‡æ ·å’Œé©±åŠ¨æ—¶åº
    // 2. é¿å…ç«äº‰æ¡ä»¶ï¼ˆrace conditionï¼‰
    // 3. æ¨¡æ‹ŸçœŸå®ç¡¬ä»¶çš„ setup/hold time
    // 4. ç¬¦åˆ UVM éªŒè¯æ–¹æ³•å­¦æ ‡å‡†
    //
    // å…³é”®æ¦‚å¿µï¼š
    // - output: testbench é©±åŠ¨ä¿¡å·åˆ° DUTï¼ˆåœ¨æ—¶é’Ÿè¾¹æ²¿å #1step é©±åŠ¨ï¼‰
    // - input:  testbench ä» DUT é‡‡æ ·ä¿¡å·ï¼ˆåœ¨æ—¶é’Ÿè¾¹æ²¿å‰ #1step é‡‡æ ·ï¼‰
    // - #1step: ä¸€ä¸ªä»¿çœŸæ—¶é—´æ­¥ï¼Œè‡ªåŠ¨é€‚åº”æ—¶é’Ÿå‘¨æœŸï¼Œä¸æ˜¯å›ºå®šçš„æ—¶é—´å€¼
    //
    // æ—¶åºè¯´æ˜ï¼š
    //   æ—¶é’Ÿè¾¹æ²¿å‰ #1step: é‡‡æ · DUT çš„è¾“å‡ºï¼ˆinput ä¿¡å·ï¼‰
    //   æ—¶é’Ÿè¾¹æ²¿:          æ—¶é’Ÿä¸Šå‡æ²¿
    //   æ—¶é’Ÿè¾¹æ²¿å #1step: é©±åŠ¨ DUT çš„è¾“å…¥ï¼ˆoutput ä¿¡å·ï¼‰
    //
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    clocking cb @(posedge clk);
        // é»˜è®¤é…ç½®ï¼šè¾“å…¥åœ¨æ—¶é’Ÿè¾¹æ²¿å‰ 1step é‡‡æ ·ï¼Œè¾“å‡ºåœ¨æ—¶é’Ÿè¾¹æ²¿å 1step é©±åŠ¨
        default input #1step output #1step;

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // Output ä¿¡å·ï¼ˆtestbench â†’ DUTï¼‰
        // è¿™äº›æ˜¯ DUT çš„è¾“å…¥ç«¯å£ï¼Œtestbench éœ€è¦é©±åŠ¨å®ƒä»¬
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        output pe_psum_in;      // éƒ¨åˆ†å’Œè¾“å…¥
        output pe_weight_in;    // æƒé‡è¾“å…¥
        output pe_accept_w_in;  // æƒé‡æ¥å—ä¿¡å·
        output pe_input_in;     // æ¿€æ´»å€¼è¾“å…¥
        output pe_valid_in;     // è¾“å…¥æœ‰æ•ˆä¿¡å·
        output pe_switch_in;    // æƒé‡åˆ‡æ¢ä¿¡å·
        output pe_enabled;      // PE ä½¿èƒ½ä¿¡å·

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // Input ä¿¡å·ï¼ˆDUT â†’ testbenchï¼‰
        // è¿™äº›æ˜¯ DUT çš„è¾“å‡ºç«¯å£ï¼Œtestbench éœ€è¦é‡‡æ ·å®ƒä»¬
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        input pe_psum_out;      // éƒ¨åˆ†å’Œè¾“å‡º
        input pe_weight_out;    // æƒé‡è¾“å‡º
        input pe_input_out;     // æ¿€æ´»å€¼è¾“å‡º
        input pe_valid_out;     // è¾“å‡ºæœ‰æ•ˆä¿¡å·
        input pe_switch_out;    // æƒé‡åˆ‡æ¢è¾“å‡º
    endclocking

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // æ—¶é’Ÿç”Ÿæˆ (10ns å‘¨æœŸ = 100MHz)
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    initial begin
        clk = 0;
        forever #5 clk = ~clk;
    end

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // FSDB æ³¢å½¢ç”Ÿæˆï¼ˆç”¨äº Verdi è°ƒè¯•ï¼‰
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    initial begin
        // ä» build/ ç›®å½•åˆ° waveforms/ éœ€è¦ä¸¤å±‚ ../
        // build/ -> ../ -> vcs/ -> ../ -> sim/ -> waveforms/
        $display("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•");
        $display("ğŸ” [DEBUG] å¼€å§‹é…ç½®FSDBæ³¢å½¢dump");
        $display("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•");

        $fsdbDumpfile("../../waveforms/tb_pe.fsdb");
        $display("âœ… [DEBUG] fsdbDumpfile å·²è°ƒç”¨");

        // å®˜æ–¹æ¨èè¯­æ³•ï¼šdepth=0è¡¨ç¤ºdumpæ‰€æœ‰å±‚æ¬¡
        $fsdbDumpvars(0, tb_pe);
        $display("âœ… [DEBUG] fsdbDumpvars(0, tb_pe) å·²è°ƒç”¨");
        $display("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");
    end

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // æ–­è¨€ï¼ˆAssertionï¼‰- ä¸º UVM éªŒè¯åšå‡†å¤‡
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    // æ–­è¨€1ï¼šå¤ä½æœŸé—´è¾“å‡ºåº”è¯¥ä¸º0
    // æ³¨æ„ï¼šå¤ä½æ˜¯åŒæ­¥å¤ä½ï¼Œéœ€è¦åœ¨å¤ä½åçš„ä¸‹ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸæ£€æŸ¥
    property reset_output_zero;
        @(posedge clk) (rst) |=> (pe_psum_out == 0);
    endproperty
    assert property (reset_output_zero)
        else $error("[ASSERTION FAIL] å¤ä½åè¾“å‡ºä¸ä¸º0!");

    // æ–­è¨€2ï¼šæ•°æ®ä¼ æ’­æ£€æŸ¥ - validä¿¡å·ä¼ æ’­åˆ°è¾“å‡º
    // æ³¨æ„ï¼šåœ¨è„‰åŠ¨é˜µåˆ—ä¸­ï¼Œvalidå¯ä»¥è¿ç»­å¤šå‘¨æœŸä¿æŒé«˜ç”µå¹³ï¼Œè¿™æ˜¯æ­£å¸¸çš„
    property valid_propagation;
        @(posedge clk) disable iff (rst)
            pe_valid_in |-> ##1 pe_valid_out;
    endproperty
    assert property (valid_propagation)
        else $warning("[ASSERTION WARN] valid ä¿¡å·æœªæ­£ç¡®ä¼ æ’­åˆ°è¾“å‡º!");

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Q8.8 å®šç‚¹æ•°è½¬æ¢å‡½æ•°
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    function automatic logic [15:0] to_fixed(real val);
        return $signed($rtoi(val * 256.0)) & 16'hFFFF;
    endfunction

    function automatic real from_fixed(logic [15:0] val);
        logic signed [15:0] signed_val;
        signed_val = val;
        return $itor(signed_val) / 256.0;
    endfunction

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // æµ‹è¯•ä»»åŠ¡ - ä½¿ç”¨ Clocking Block
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // ä»»åŠ¡ï¼šå¤ä½ DUT
    // è¯´æ˜ï¼š
    //   - å¤ä½ä¿¡å· rst ä¸é€šè¿‡ clocking blockï¼Œå› ä¸ºå®ƒéœ€è¦ç«‹å³ç”Ÿæ•ˆ
    //   - å…¶ä»–ä¿¡å·é€šè¿‡ clocking block é©±åŠ¨ï¼Œç¡®ä¿æ—¶åºæ­£ç¡®
    //   - ä½¿ç”¨éé˜»å¡èµ‹å€¼ï¼ˆ<=ï¼‰é©±åŠ¨ clocking block çš„è¾“å‡ºä¿¡å·
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    task automatic reset_dut();
        $display("[%0t] ğŸ”„ å¤ä½ DUT", $time);

        // å¤ä½ä¿¡å·ç›´æ¥é©±åŠ¨ï¼ˆä¸é€šè¿‡ clocking blockï¼‰
        rst = 1;

        // å…¶ä»–ä¿¡å·é€šè¿‡ clocking block é©±åŠ¨
        cb.pe_enabled <= 0;
        cb.pe_valid_in <= 0;
        cb.pe_accept_w_in <= 0;
        cb.pe_switch_in <= 0;
        cb.pe_input_in <= 16'h0000;
        cb.pe_weight_in <= 16'h0000;
        cb.pe_psum_in <= 16'h0000;

        // ç­‰å¾…3ä¸ªæ—¶é’Ÿå‘¨æœŸ
        repeat(3) @(cb);

        // é‡Šæ”¾å¤ä½
        rst = 0;
        cb.pe_enabled <= 1;

        // ç­‰å¾…1ä¸ªæ—¶é’Ÿå‘¨æœŸ
        @(cb);

        $display("[%0t] âœ… å¤ä½å®Œæˆ\n", $time);
    endtask

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // ä»»åŠ¡ï¼šåŠ è½½æƒé‡åˆ°åå°å¯„å­˜å™¨
    // è¯´æ˜ï¼š
    //   - ä½¿ç”¨ clocking block é©±åŠ¨ä¿¡å·ï¼Œè‡ªåŠ¨å¤„ç†æ—¶åº
    //   - cb.signal <= value: åœ¨æ—¶é’Ÿè¾¹æ²¿å #1step é©±åŠ¨ä¿¡å·
    //   - @(cb): ç­‰å¾…ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸ
    //   - å¿…é¡»ä½¿ç”¨éé˜»å¡èµ‹å€¼ï¼ˆ<=ï¼‰
    //
    // æ—¶åºï¼š
    //   T0: é©±åŠ¨ pe_accept_w_in=1, pe_weight_in=weight_val
    //   T0+1step: ä¿¡å·å®é™…å˜åŒ–
    //   T1: DUT åœ¨æ—¶é’Ÿè¾¹æ²¿é‡‡æ ·ä¿¡å·
    //   T1: é©±åŠ¨ pe_accept_w_in=0
    //   T1+1step: ä¿¡å·å®é™…å˜åŒ–
    //   T2: å®Œæˆ
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    task automatic load_weight(real weight_val);
        $display("[%0t] ğŸ“¥ åŠ è½½æƒé‡: %.2f", $time, weight_val);

        // é€šè¿‡ clocking block é©±åŠ¨ä¿¡å·ï¼ˆéé˜»å¡èµ‹å€¼ï¼‰
        cb.pe_accept_w_in <= 1;
        cb.pe_weight_in <= to_fixed(weight_val);

        // ç­‰å¾…ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸï¼ˆDUT é‡‡æ ·ä¿¡å·ï¼‰
        @(cb);

        // æ¸…é™¤ accept ä¿¡å·
        cb.pe_accept_w_in <= 0;

        // å†ç­‰å¾…ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸï¼ˆç¡®ä¿ä¿¡å·ç¨³å®šï¼‰
        @(cb);

        $display("[%0t] âœ… æƒé‡å·²åŠ è½½åˆ°åå°å¯„å­˜å™¨", $time);
    endtask

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // ä»»åŠ¡ï¼šåˆ‡æ¢æƒé‡ï¼ˆåå°å¯„å­˜å™¨ â†’ å‰å°å¯„å­˜å™¨ï¼‰
    // è¯´æ˜ï¼š
    //   - ä½¿ç”¨ clocking block é©±åŠ¨ pe_switch_in ä¿¡å·
    //   - æƒé‡åˆ‡æ¢éœ€è¦1ä¸ªæ—¶é’Ÿå‘¨æœŸå®Œæˆï¼ˆçº¯æ—¶åºé€»è¾‘ï¼‰
    //
    // æ—¶åºï¼š
    //   T0: é©±åŠ¨ pe_switch_in=1
    //   T1: DUT é‡‡æ ·ä¿¡å·ï¼Œæ‰§è¡Œåˆ‡æ¢
    //   T1: é©±åŠ¨ pe_switch_in=0
    //   T2: åˆ‡æ¢å®Œæˆ
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    task automatic switch_weight();
        $display("[%0t] ğŸ”„ åˆ‡æ¢æƒé‡ï¼ˆåå°â†’å‰å°ï¼‰", $time);

        // é©±åŠ¨åˆ‡æ¢ä¿¡å·
        cb.pe_switch_in <= 1;

        // ç­‰å¾…ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸï¼ˆDUT æ‰§è¡Œåˆ‡æ¢ï¼‰
        @(cb);

        // æ¸…é™¤åˆ‡æ¢ä¿¡å·
        cb.pe_switch_in <= 0;

        // ç­‰å¾…åˆ‡æ¢å®Œæˆï¼ˆçº¯æ—¶åºé€»è¾‘éœ€è¦1å‘¨æœŸï¼‰
        @(cb);

        $display("[%0t] âœ… æƒé‡åˆ‡æ¢å®Œæˆ", $time);
    endtask

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // ä»»åŠ¡ï¼šMAC è¿ç®—éªŒè¯
    // è¯´æ˜ï¼š
    //   - ä½¿ç”¨ clocking block é©±åŠ¨è¾“å…¥å’Œé‡‡æ ·è¾“å‡º
    //   - é©±åŠ¨è¾“å…¥ï¼šcb.signal <= valueï¼ˆéé˜»å¡èµ‹å€¼ï¼‰
    //   - é‡‡æ ·è¾“å‡ºï¼švalue = cb.signalï¼ˆé˜»å¡èµ‹å€¼ï¼‰
    //   - PE çš„æµæ°´çº¿å»¶è¿Ÿæ˜¯ 1 ä¸ªæ—¶é’Ÿå‘¨æœŸ
    //
    // æ—¶åºï¼š
    //   T0: é©±åŠ¨è¾“å…¥ä¿¡å·ï¼ˆpe_input_in, pe_psum_in, pe_valid_in=1ï¼‰
    //   T0+1step: ä¿¡å·å®é™…å˜åŒ–
    //   T1: DUT åœ¨æ—¶é’Ÿè¾¹æ²¿é‡‡æ ·è¾“å…¥ï¼Œå¼€å§‹è®¡ç®—
    //   T1: ç­‰å¾…ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸ
    //   T2-1step: clocking block è‡ªåŠ¨é‡‡æ ·è¾“å‡º
    //   T2: è¯»å–é‡‡æ ·çš„è¾“å‡ºå€¼
    //   T2: æ¸…é™¤ valid ä¿¡å·
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    task automatic mac_operation(
        input real input_val,
        input real psum_val,
        input real expected_out,
        input string test_name
    );
        real actual_out;
        real error;

        test_count++;
        $display("[%0t] ğŸ§® MAC è¿ç®— [%s]: %.2f * weight + %.2f",
                 $time, test_name, input_val, psum_val);

        // é€šè¿‡ clocking block é©±åŠ¨è¾“å…¥ä¿¡å·ï¼ˆéé˜»å¡èµ‹å€¼ï¼‰
        cb.pe_input_in <= to_fixed(input_val);
        cb.pe_psum_in <= to_fixed(psum_val);
        cb.pe_valid_in <= 1;

        // ç­‰å¾…ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸï¼ˆT1: DUT é‡‡æ ·è¾“å…¥ï¼‰
        @(cb);

        // ç­‰å¾…ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸï¼ˆT2: DUT è¾“å‡ºç»“æœï¼Œæµæ°´çº¿å»¶è¿Ÿ=1ï¼‰
        @(cb);

        // é€šè¿‡ clocking block é‡‡æ ·è¾“å‡ºï¼ˆé˜»å¡èµ‹å€¼ï¼‰
        // æ³¨æ„ï¼šclocking block å·²ç»åœ¨ T2-1step è‡ªåŠ¨é‡‡æ ·äº†è¾“å‡º
        actual_out = from_fixed(cb.pe_psum_out);
        error = $abs(actual_out - expected_out);

        // æ¸…é™¤ valid ä¿¡å·
        cb.pe_valid_in <= 0;

        $display("[%0t] ğŸ“Š æœŸæœ›: %.4f, å®é™…: %.4f, è¯¯å·®: %.4f (0x%04h)",
                 $time, expected_out, actual_out, error, cb.pe_psum_out);

        // Q8.8 å®šç‚¹æ•°ç²¾åº¦çº¦ä¸º 1/256 â‰ˆ 0.0039
        // è€ƒè™‘åˆ°ä¹˜æ³•ç´¯ç§¯è¯¯å·®ï¼Œè®¾ç½®å®¹å·®ä¸º 0.02ï¼ˆçº¦5ä¸ªLSBï¼‰
        if (error < 0.02) begin
            $display("[%0t] âœ… PASS\n", $time);
            pass_count++;
        end else begin
            $display("[%0t] âŒ FAIL - è¯¯å·®è¶…å‡ºå®¹å·®èŒƒå›´!\n", $time);
            fail_count++;
        end
    endtask

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // éšæœºæµ‹è¯•ä»»åŠ¡ï¼ˆä¸º UVM åšå‡†å¤‡ï¼‰
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    task automatic random_mac_test(input int num_tests, input real weight_val);
        real rand_input, rand_psum, expected;
        int seed = $urandom();  // éšæœºç§å­

        $display("[%0t] ğŸ² å¼€å§‹éšæœºæµ‹è¯• (%0d æ¬¡)", $time, num_tests);
        $display("[%0t] ğŸ”‘ éšæœºç§å­: %0d", $time, seed);

        load_weight(weight_val);
        switch_weight();

        for (int i = 0; i < num_tests; i++) begin
            // ç”Ÿæˆéšæœºæ•°ï¼ˆèŒƒå›´ï¼š-2.0 ~ 2.0ï¼‰
            // é™åˆ¶èŒƒå›´ä»¥é¿å…è¶…å‡º Q8.8 è¡¨ç¤ºèŒƒå›´ï¼ˆ-128 ~ 127.996ï¼‰
            // å¯¹äº weight=1.5ï¼Œæœ€å¤§è¾“å‡ºçº¦ä¸º 2.0*1.5+2.0=5.0ï¼Œå®‰å…¨èŒƒå›´å†…
            rand_input = ($urandom_range(0, 400) - 200) / 100.0;
            rand_psum = ($urandom_range(0, 400) - 200) / 100.0;

            // è®¡ç®—æœŸæœ›å€¼
            expected = rand_input * weight_val + rand_psum;

            // æ£€æŸ¥æ˜¯å¦è¶…å‡º Q8.8 è¡¨ç¤ºèŒƒå›´
            if (expected > 127.0 || expected < -128.0) begin
                $display("[%0t] âš ï¸  è·³è¿‡æµ‹è¯•-%0d: æœŸæœ›å€¼ %.4f è¶…å‡º Q8.8 èŒƒå›´",
                         $time, i+1, expected);
                continue;
            end

            // æ‰§è¡Œ MAC è¿ç®—
            mac_operation(rand_input, rand_psum, expected,
                         $sformatf("éšæœºæµ‹è¯•-%0d", i+1));
        end

        $display("[%0t] âœ… éšæœºæµ‹è¯•å®Œæˆ\n", $time);
    endtask

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ä¸»æµ‹è¯•æµç¨‹
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    initial begin
        $display("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•");
        $display("ğŸ§ª PE Module Testbench - Professional Version");
        $display("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•");
        $display("æµ‹è¯•å†…å®¹:");
        $display("  1. æƒé‡åŠ è½½åˆ°åå°å¯„å­˜å™¨");
        $display("  2. æƒé‡åˆ‡æ¢åˆ°å‰å°å¯„å­˜å™¨");
        $display("  3. MAC è¿ç®—éªŒè¯ (5ä¸ªå®šå‘æµ‹è¯•)");
        $display("  4. éšæœºæµ‹è¯• (%0d æ¬¡)", random_test_num);
        $display("  5. æ–­è¨€æ£€æŸ¥ï¼ˆAssertionï¼‰");
        $display("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // Test 1: åŸºç¡€ MAC è¿ç®—
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        $display("[Test 1] åŸºç¡€ MAC è¿ç®—");
        $display("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€");

        reset_dut();
        load_weight(2.0);
        switch_weight();
        mac_operation(3.0, 1.0, 7.0, "åŸºç¡€è¿ç®—");

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // Test 2: é›¶å€¼æµ‹è¯•
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        $display("[Test 2] é›¶å€¼æµ‹è¯•");
        $display("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€");

        reset_dut();
        load_weight(0.0);
        switch_weight();
        mac_operation(5.0, 0.0, 0.0, "é›¶æƒé‡");

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // Test 3: è´Ÿæ•°æµ‹è¯•
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        $display("[Test 3] è´Ÿæ•°æµ‹è¯•");
        $display("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€");

        reset_dut();
        load_weight(-1.5);
        switch_weight();
        mac_operation(2.0, 4.0, 1.0, "è´Ÿæƒé‡");

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // Test 4: å°æ•°ç²¾åº¦æµ‹è¯•
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        $display("[Test 4] å°æ•°ç²¾åº¦æµ‹è¯•");
        $display("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€");

        reset_dut();
        load_weight(0.5);
        switch_weight();
        mac_operation(1.25, 0.25, 0.875, "å°æ•°ç²¾åº¦");

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // Test 5: è¿ç»­ MAC è¿ç®—
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        $display("[Test 6] è¿ç»­ MAC è¿ç®—");
        $display("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€");

        reset_dut();
        load_weight(1.0);
        switch_weight();
        mac_operation(1.0, 0.0, 1.0, "è¿ç»­-1");
        mac_operation(2.0, 0.0, 2.0, "è¿ç»­-2");
        mac_operation(3.0, 0.0, 3.0, "è¿ç»­-3");

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // Test 6: éšæœºæµ‹è¯•ï¼ˆæ–°å¢ï¼ï¼‰
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        $display("[Test 6] éšæœºæµ‹è¯•");
        $display("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€");

        reset_dut();
        random_mac_test(random_test_num, 1.5);  // æƒé‡=1.5ï¼Œè¿è¡Œ10æ¬¡éšæœºæµ‹è¯•

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // æµ‹è¯•å®Œæˆ - æ‰“å°ç»Ÿè®¡ä¿¡æ¯
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        repeat(10) @(posedge clk);

        $display("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•");
        $display("ğŸ“Š æµ‹è¯•ç»Ÿè®¡");
        $display("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•");
        $display("  æ€»æµ‹è¯•æ•°: %0d", test_count);
        $display("  é€šè¿‡æ•°:   %0d", pass_count);
        $display("  å¤±è´¥æ•°:   %0d", fail_count);
        $display("  é€šè¿‡ç‡:   %.1f%%", (pass_count * 100.0) / test_count);
        $display("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•");

        if (fail_count == 0) begin
            $display("âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡!");
            $display("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");
            $finish(0);  // è¿”å› 0 è¡¨ç¤ºæˆåŠŸ
        end else begin
            $display("âŒ æœ‰ %0d ä¸ªæµ‹è¯•å¤±è´¥!", fail_count);
            $display("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");
            $finish(1);  // è¿”å› 1 è¡¨ç¤ºå¤±è´¥
        end
    end

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // è¶…æ—¶ä¿æŠ¤
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    initial begin
        #10000;  // 10us è¶…æ—¶
        $display("\nâŒ æµ‹è¯•è¶…æ—¶!");
        $display("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");
        $finish(2);  // è¿”å› 2 è¡¨ç¤ºè¶…æ—¶
    end

endmodule

`default_nettype wire
